global:
  stackName: aws-infra-forge
  dualStack: true
  description: 'Enterprise-grade Solana/Agave RPC Node Deployment Solution: Supports multiple Solana networks (mainnet, devnet, testnet) and node types (basic, extended, consensus). For consensus nodes, validator-keypair.json and vote-account-keypair.json must be placed in the home directory of the default user and the agave-validator service restarted (sudo systemctl restart agave-validator). Validated instance configurations for Solana mainnet synchronization include: r6idn.16xlarge with Instance Store, i8g.16xlarge with Instance Store, r7a.16xlarge with 4TB io2 (100,000 IOPS), r8g.16xlarge with 4TB io2 (100,000 IOPS), and r7i.16xlarge with 4TB io2 (100,000 IOPS). The solution automatically utilizes instance store when available for optimal performance. For ARM64 platforms, Agave is compiled from source and then synchronized automatically.'
enabledForges:
  - agaver7a
forges:
  vpc:
    defaults:
      id: vpc
      type: VPC
      cidrBlock: 10.69.0.0/16
      natGatewayPerAZ: false
  ec2:
    defaults:
      type: EC2
      security: private
      subnet: private
      azIndex: 2
      debug: false
      instanceType: c7g.xlarge
      instanceCount: 1
      keyName: aws-infra-forge
      detailedMonitoring: false
      ebsVolumeType: gp3
      ebsSize: "30"
      ebsThroughput: "125"
      ebsIops: "3000"
      ebsOptimized: false
      enclaveEnabled: false
      networkCardCount: 1
      eniCount: 1
      purchaseOption: od
      spotMaxPrice: ""
      capacityBlockId: ""
      enableEfa: false
      enaSrdEnabled: false
      osArch: aarch64
      osName: amazon
      osType: linux
      osVersion: "2023"
      policies: AmazonS3FullAccess,AmazonSSMManagedInstanceCore
      s3Location: s3://aws-infra-forge
      allowedPorts: 22@0.0.0.0/0;80,443,8443@10.69.0.0/16
      allowedPortsIpv6: 22,80,443,8443@::/0
      requireImdsv2: true
      userDataScriptPath: ""
      userDataToken: sysinfo
    instances:
      - id: agavei8g
        security: public
        subnet: public
        ebsSize: "100"
        instanceType: i8g.16xlarge
        allowedPorts: 22,80,443,8443,8000-8020@0.0.0.0/0
        allowedPortsIpv6: 22,80,443,8443,8000-8020@::/0
        userDataToken: agave-nonroot:cluster=mainnet;nodetype=basic
      - id: agaver7a
        security: public
        subnet: public
        instanceType: r7a.16xlarge
        allowedPorts: 22,80,443,8443,8000-8020@0.0.0.0/0
        allowedPortsIpv6: 22,80,443,8443,8000-8020@::/0
        ebsVolumeType: io2
        ebsSize: "4096"
        ebsIops: "100000"
        osArch: x86_64
        userDataToken: agave-nonroot:cluster=mainnet;nodetype=basic
